<!DOCTYPE html>
<html>

<button onclick="gettoken()">gettoken</button>
<input id="fileUploadControl" name="fileUploadControl" type="file" onchange="openfile(event)" />
<button onclick="launch2()"> save to onedrive direct file </button>	

<script type="text/javascript" src="https://js.live.net/v7.0/OneDrive.js"></script>
<script>
	
 
/*function gettoken() 
{
	var a=document.URL;
	var b="\'"+a+"\'";

	var url = b,access_token = url.match(/\#(?:access_token)\=([\S\s]*?)\&/)[1];
	window.alert("Token:"+access_token);
	
}*/

var data;
function launch2() 
{window.alert("launch2");
	var a=document.URL;
	var b="\'"+a+"\'";

	var url = b,access_token = url.match(/\#(?:access_token)\=([\S\s]*?)\&/)[1];
	var abc=access_token;
	  var odOptions = {
	  clientId: "eb8f333c-fc44-4183-b60b-c4c8c50e2509",
	  access_token=abc;
		  
	  action: "save",
	  sourceInputElementId: "fileUploadControl",
	  sourceUri: "",
	  fileName: "fil.txt",
	  openInNewWindow: true,
	  advanced: {},

	  success: function(files) { window.alert("Save to onedrive");console.log('success');},

	  progress: function(p) {console.log("2"); },
	  cancel: function() {console.log("3"); },
	  error: function(e) { console.log(e); }
	};

	console.log("6");
	OneDrive.save(odOptions);
	window.alert("Save to onedrive");
}

var openfile= function(event)
{

	var input= event.target;
	var reader=new FileReader();
	var save = function (dataURL)
	{
	    data=dataURL;
	};

	reader.onload= function()
	{
	save(reader.result);
	console.log("1");
        }

      reader.readAsDataURL(input.files[0]);
}
	
</script>
</html>

   


	  
    
    
    
      
        

   















